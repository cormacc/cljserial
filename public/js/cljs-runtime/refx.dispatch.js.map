{"version":3,"sources":["refx/dispatch.cljc"],"mappings":"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","names":["refx.dispatch/later-fns","f","G__86560","refx.interop/after-render","refx.interop/next-tick","refx$dispatch$IEventQueue$push$dyn","x__5350__auto__","m__5351__auto__","refx.dispatch/push","goog/typeOf","m__5349__auto__","cljs.core/missing-protocol","refx$dispatch$IEventQueue$add_post_event_callback$dyn","refx.dispatch/add-post-event-callback","refx$dispatch$IEventQueue$remove_post_event_callback$dyn","refx.dispatch/remove-post-event-callback","refx$dispatch$IEventQueue$purge$dyn","refx.dispatch/purge","refx$dispatch$IEventQueue$_fsm_trigger$dyn","refx.dispatch/-fsm-trigger","refx$dispatch$IEventQueue$_add_event$dyn","refx.dispatch/-add-event","refx$dispatch$IEventQueue$_process_1st_event_in_queue$dyn","refx.dispatch/-process-1st-event-in-queue","refx$dispatch$IEventQueue$_run_next_tick$dyn","refx.dispatch/-run-next-tick","refx$dispatch$IEventQueue$_run_queue$dyn","refx.dispatch/-run-queue","refx$dispatch$IEventQueue$_exception$dyn","refx.dispatch/-exception","refx$dispatch$IEventQueue$_pause$dyn","refx.dispatch/-pause","refx$dispatch$IEventQueue$_resume$dyn","refx.dispatch/-resume","refx$dispatch$IEventQueue$_call_post_event_callbacks$dyn","refx.dispatch/-call-post-event-callbacks","refx.dispatch/IEventQueue","this","event","id","callback-fn","trigger","arg","ex","later-fn","cljs.core/PROTOCOL_SENTINEL","this__5287__auto__","writer__5288__auto__","opt__5289__auto__","cljs.core/-write","refx.dispatch/EventQueue","refx.dispatch/->EventQueue","fsm-state","queue","post-event-callback-fns","_","cljs.core/contains?","refx.log.warn","cljs.core.assoc","cljs.core.dissoc","refx.interop/empty-queue","vec__86703","cljs.core.nth","new-fsm-state","action-fn","G__86706","cljs.core._EQ_","cljs.core/empty?","cljs.core.ex_info","cljs.core.conj","event-v","cljs.core/peek","e86726","refx.events/handle","cljs.core/pop","G__86702","n","cljs.core/count","temp__5821__auto__","cljs.core/some","cljs.core/meta","cljs.core/keys","G__86718","seq__86738","cljs.core/seq","chunk__86739","count__86740","i__86741","temp__5823__auto__","cljs.core/chunked-seq?","c__5525__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/first","cljs.core/next","callback","cljs.core/vals","refx.dispatch/event-queue","refx.dispatch/dispatch","refx.dispatch/dispatch-sync"],"sourcesContent":["(ns refx.dispatch\n  (:require [refx.interop :refer [after-render empty-queue next-tick]]\n            [refx.events :as events]\n            [refx.log :as log]))\n\n(def later-fns\n  {:flush-dom (fn [f] (after-render #(next-tick f)))\n   :yield     next-tick})\n\n(defprotocol IEventQueue\n  ;; -- API\n  (push [this event])\n  (add-post-event-callback [this id callback-fn])\n  (remove-post-event-callback [this id])\n  (purge [this])\n\n  ;; -- Implementation via a Finite State Machine\n  (-fsm-trigger [this trigger arg])\n\n  ;; -- Finite State Machine actions\n  (-add-event [this event])\n  (-process-1st-event-in-queue [this])\n  (-run-next-tick [this])\n  (-run-queue [this])\n  (-exception [this ex])\n  (-pause [this later-fn])\n  (-resume [this])\n  (-call-post-event-callbacks [this event]))\n\n(deftype EventQueue [^:mutable fsm-state\n                     ^:mutable queue\n                     ^:mutable post-event-callback-fns]\n  IEventQueue\n\n  (push [this event]\n    (-fsm-trigger this :add-event event))\n\n  (add-post-event-callback [_ id callback-fn]\n    (when (contains? post-event-callback-fns id)\n      (log/warn \"overwriting existing post event call back with id:\" id))\n    (->> (assoc post-event-callback-fns id callback-fn)\n         (set! post-event-callback-fns)))\n\n  (remove-post-event-callback [_ id]\n    (if-not (contains? post-event-callback-fns id)\n      (log/warn \"could not remove post event call back with id:\" id)\n      (->> (dissoc post-event-callback-fns id)\n           (set! post-event-callback-fns))))\n\n  (purge [_]\n    (set! queue empty-queue))\n\n  (-fsm-trigger\n    [this trigger arg]\n    (locking this\n      (let [[new-fsm-state action-fn]\n            (case [fsm-state trigger]\n              [:idle :add-event] [:scheduled #(do (-add-event this arg)\n                                                  (-run-next-tick this))]\n\n              [:scheduled :add-event] [:scheduled #(-add-event this arg)]\n              [:scheduled :run-queue] [:running #(-run-queue this)]\n\n              [:running :add-event]  [:running #(-add-event this arg)]\n              [:running :pause]      [:paused #(-pause this arg)]\n              [:running :exception]  [:idle #(-exception this arg)]\n              [:running :finish-run] (if (empty? queue)\n                                       [:idle]\n                                       [:scheduled #(-run-next-tick this)])\n\n              [:paused :add-event] [:paused #(-add-event this arg)]\n              [:paused :resume]    [:running #(-resume this)]\n\n              (throw (ex-info (str \"router state transition not found. \" fsm-state \" \" trigger)\n                              {:fsm-state fsm-state, :trigger trigger})))]\n        (set! fsm-state new-fsm-state)\n        (when action-fn (action-fn)))))\n\n  (-add-event\n    [_ event]\n    (set! queue (conj queue event)))\n\n  (-process-1st-event-in-queue\n    [this]\n    (let [event-v (peek queue)]\n      (try\n        (events/handle event-v)\n        (set! queue (pop queue))\n        (-call-post-event-callbacks this event-v)\n        (catch #?(:cljs :default :clj Exception) ex\n          (-fsm-trigger this :exception ex)))))\n\n  (-run-next-tick\n    [this]\n    (next-tick #(-fsm-trigger this :run-queue nil)))\n\n  (-run-queue\n    [this]\n    (loop [n (count queue)]\n      (if (zero? n)\n        (-fsm-trigger this :finish-run nil)\n        (if-let [later-fn (some later-fns (-> queue peek meta keys))]\n          (-fsm-trigger this :pause later-fn)\n          (do (-process-1st-event-in-queue this)\n              (recur (dec n)))))))\n\n  (-exception\n    [this ex]\n    (purge this)\n    (throw ex))\n\n  (-pause\n    [this later-fn]\n    (later-fn #(-fsm-trigger this :resume nil)))\n\n  (-call-post-event-callbacks\n    [_ event-v]\n    (doseq [callback (vals post-event-callback-fns)]\n      (callback event-v queue)))\n\n  (-resume\n    [this]\n    (-process-1st-event-in-queue this)\n    (-run-queue this)))\n\n;; TODO: Will there ever be more than one?\n(def event-queue (->EventQueue :idle empty-queue {}))\n\n(defn dispatch\n  [event]\n  (if (nil? event)\n    (throw (ex-info \"you called \\\"dispatch\\\" without an event vector.\" {}))\n    (push event-queue event))\n  nil)\n\n(defn dispatch-sync\n  [event-v]\n  (events/handle event-v)\n  (-call-post-event-callbacks event-queue event-v)\n  nil)\n"],"x_google_ignoreList":[0]}