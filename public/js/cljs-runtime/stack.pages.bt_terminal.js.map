{"version":3,"sources":["stack/pages/bt_terminal.cljs"],"mappings":"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","names":["props__38769__auto__","clj-props__38770__auto__","uix.core/glue-args","vec__84341","map__84344","cljs.core.nth","cljs.core/--destructure-map","cljs.core.get","f__38771__auto__","js/goog.DEBUG","temp__5823__auto__","stack.pages.bt-terminal/term-widget-dbfx","f__38700__auto__","*current-component*-orig-val__84367","uix.core/*current-component*","*current-component*-temp-val__84368","cljs.core/map?","js/Error","js/window","js/window.uix","js/window.uix.dev","sig__38709__auto__","js/window.uix.dev.signature!","js/window.uix.dev.register!","event-sub","tx-event-id","props","events","G__84358","stack.utils.dbfx/use-sub","uix.compiler.alpha/component-element","p1__84335#","stack.components.term/term-widget","cljs.core/seq","G__84361","stack.utils.dbfx/dispatch","f__38767__auto__","stack.pages.bt-terminal/bluetooth-unsupported-message","*current-component*-orig-val__84378","*current-component*-temp-val__84379","uix.compiler.aot/>el","uix.compiler.attributes/interpret-attrs","stack.pages.bt-terminal/side-panel","*current-component*-orig-val__84392","*current-component*-temp-val__84393","bt-context","stack.utils.hsm/use-sub-context","device","js/goog.debug.LOGGING_ENABLED","lambdaisland.glogi.log","cljs.core/identity","stack.components.bt-device/settings","cljs.core.partial","stack.services.bt/device-request-callback","G__84388","stack.pages.bt-terminal/terminal-pane","*current-component*-orig-val__84402","*current-component*-temp-val__84403","bt-state","stack.utils.hsm/use-sub-state","stack.utils.hsm/in-state","stack.pages.bt-terminal/layout","*current-component*-orig-val__84406","*current-component*-temp-val__84407"],"sourcesContent":["(ns stack.pages.bt-terminal\n  (:require\n   [lambdaisland.glogi :as log]\n   [uix.core :refer [defui $]]\n   [stack.utils.dbfx :as dbfx]\n   [stack.utils.hsm :as hsm-dbfx]\n   [stack.services.bt :as bt]\n   [stack.components.bt-device :as bt-device]\n   [stack.components.term :as term]))\n\n\n(defui term-widget-dbfx [{:keys [event-sub tx-event-id] :as props}]\n  (let [events (dbfx/use-sub [event-sub])]\n    ($ term/term-widget {:events events\n                         :on-add-event #(when (seq %)\n                                          (dbfx/dispatch [tx-event-id %]))})))\n\n(defui bluetooth-unsupported-message []\n  ($ :div \"The Web Bluetooth API is not currently available. Make sure you're running Chrome, Edge or Opera and serving this page from a secure context (i.e. over a https link or from localhost).  See Mozilla documentation for more details on \" ($ :a {:href \"https://developer.mozilla.org/en-US/docs/Web/API/Bluetooth#browser_compatibility\"} \"browser support\") \", and \" ($ :a {:href \"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"} \"secure contexts\") \".\"))\n\n(defui side-panel []\n  ($ :.flex.flex-col\n     (let [bt-context (hsm-dbfx/use-sub-context :bt-serial)\n           device (:device bt-context)]\n       (log/debug :bt-terminal/options (:options bt-context))\n       ($ bt-device/settings\n          {:device device\n           :on-device-request (partial bt/device-request-callback (:options bt-context))\n           :on-device-forget #(dbfx/dispatch [:bt-disconnect])}))))\n\n(defui terminal-pane []\n  ($ :.flex.flex-col\n     (let [bt-state (hsm-dbfx/use-sub-state :bt-serial)]\n       (log/debug :terminal/layout (str \"Rendering webbluetooth hsm state \" bt-state))\n       (if (hsm-dbfx/in-state bt-state :unsupported)\n         ($ bluetooth-unsupported-message)\n         ($ term-widget-dbfx {:event-sub :bt-serial-events :tx-event-id :bt-serial-tx})))))\n\n(defui layout []\n  ($ :.flex.flex-row.gap-1\n     ($ :.basis-80.grow-0 ($ side-panel))\n     ($ :.basis-0.grow\n        ($ terminal-pane))))\n"]}