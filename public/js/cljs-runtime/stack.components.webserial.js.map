{"version":3,"sources":["stack/components/webserial.cljc"],"mappings":"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","names":["f__35372__auto__","cljs.core/with-meta","args__35358__auto__","vec__63926","cljs.core.nth","_","res__35359__auto__","G__63971","cljs.core/vector?","cljs.core/first","alias__35373__auto__","replicant.alias/register!","stack.components.webserial/unsupported-message","attrs","stack.components.webserial/CONFIG-OPTIONS","stack.schema.webserial/PORT-FILTERS","stack.schema.webserial/BAUD-RATES","stack.schema.webserial/DATA-BITS","stack.schema.webserial/STOP-BITS","stack.schema.webserial/PARITY","stack.schema.webserial/FLOW-CONTROL","vec__64017","map__64020","cljs.core/--destructure-map","cljs.core.get","G__64064","stack.components.webserial/port-option-select","option-id","config","has-port","interpolator","_attrs","_children","current-value","cljs.core.map","b","vec__64082","map__64085","G__64131","stack.components.webserial/port-config","port","port-description","port-config","p__64111","map__64120","usbVendorId","f","stack.schema.webserial/describe-port-filter"],"sourcesContent":["(ns stack.components.webserial\n  (:require [replicant.alias :refer [defalias]]\n\n            [stack.components.layout :as layout]\n            [stack.components.forms :as forms]\n            [stack.schema.webserial :as webserial]))\n\n(defalias unsupported-message [attrs]\n  [:div attrs \"The Web Serial API is not currently available. Make sure you're running Chrome, Edge or Safari and serving this page from a secure context (i.e. over a https link or from localhost).  See Mozilla documentation for more details on \" [:a {:href \"https://developer.mozilla.org/en-US/docs/Web/API/Web_Serial_API#browser_compatibility\"} \"browser support\"] \", and \" [:a {:href \"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"} \"secure contexts\"] \".\"])\n\n(def CONFIG-OPTIONS {:vendorIdFilter webserial/PORT-FILTERS\n                     :baudRate webserial/BAUD-RATES\n                     :dataBits webserial/DATA-BITS\n                     :stopBits webserial/STOP-BITS\n                     :parity webserial/PARITY\n                     :flowControl webserial/FLOW-CONTROL})\n\n(defalias port-option-select [{:keys [option-id config has-port interpolator] :as _attrs} _children]\n  (let [current-value (option-id config)]\n    [::forms/select.w-full.text-xs.py-0\n     {::forms/selected current-value\n      ::forms/options (map (fn [b] {:key b :value b :content (str b)}) (get CONFIG-OPTIONS option-id))\n      :disabled has-port\n      :on {:change [[:view/assoc-in [:webserial :port-config option-id] interpolator]]}}]))\n\n(defalias port-config [{:keys [port port-description port-config] :as _attrs} _children]\n  (let [has-port (not (nil? port))]\n    [::layout/card\n     [::layout/header\n      [:div.flex.flex-wrap.justify-between\n       [:h3.font-semibold \"Port settings\"]\n       (if has-port\n         [:button.btn.btn-outline.btn-secondary.btn-xs\n          {:on {:click [[:webserial :forget-port]]}}\n          \"Close port\"]\n         [:button.btn.btn-outline.btn-primary.btn-xs\n          {:on {:click [[:webserial :request-port (:vendorIdFilter port-config)]]}}\n          \"Request port\"])]]\n     [::layout/content\n      [:table.table\n       [:tbody\n        (if has-port\n          [:tr [:td \"Port\"] [:td port-description]]\n          [:tr\n           [:td \"Port filter\"]\n           [:td [::forms/select.w-full.text-xs.py-0\n                 {::forms/selected (:vendorIdFilter port-config)\n                  ::forms/options (map (fn [{:keys [usbVendorId] :as f}]\n                                         {:key usbVendorId :value usbVendorId :content (webserial/describe-port-filter f)}) webserial/PORT-FILTERS)\n                  :disabled has-port\n                  :on {:change [[:view/assoc-in [:webserial :port-config :vendorIdFilter] :event/target.value-as-int]]}}]]])\n        [:tr\n         [:td \"Baud rate\"]\n         [:td [::port-option-select {:option-id :baudRate :config port-config :has-port has-port :interpolator :event/target.value-as-int}]]]\n        [:tr\n         [:td \"Data bits\"]\n         [:td [::port-option-select {:option-id :dataBits :config port-config :has-port has-port :interpolator :event/target.value-as-int}]]]\n        [:tr\n         [:td \"Stop bits\"]\n         [:td [::port-option-select {:option-id :stopBits :config port-config :has-port has-port :interpolator :event/target.value-as-int}]]]\n        [:tr\n         [:td \"Parity\"]\n         [:td [::port-option-select {:option-id :parity :config port-config :has-port has-port :interpolator :event/target.value-as-keyword}]]]\n        [:tr\n         [:td \"Flow control\"]\n         [:td [::port-option-select {:option-id :flowControl :config port-config :has-port has-port :interpolator :event/target.value-as-keyword}]]]\n\n;;;\n        ]]]]))\n"]}